group_by(4:24, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test2 <- test %>%
group_by(test[4:24], harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test2 <- test %>%
group_by(names(test[4:24]), harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test %>%
pivot_longer(4:24)
?pivot_longer
test %>%
pivot_longer(4:24, names_to = "parliament", values_to = "indicator")
test %>%
pivot_longer(4:24, names_to = "parliament", values_to = "indicator") %>%
select(indicator == 1)
test %>%
pivot_longer(4:24, names_to = "parliament", values_to = "indicator") %>%
filter(indicator == 1)
test %>%
pivot_longer(4:24, names_to = "parliament", values_to = "indicator") %>%
filter(indicator == 1) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test2 <- test %>%
pivot_longer(4:24, names_to = "parliament", values_to = "indicator") %>%
filter(indicator == 1) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
View(test2)
View(test)
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, na.omit(yod)) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1 && na.omit(yod)) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
View(test2)
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1 & na.omit(yod)) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, na.omit(yod)) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1)) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1) %>%
group_by(parliament, harnas2, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
View(test2)
# Dataframe of all lower house members
parl <- read_excel("Elections/Data/Parlementen.xlsx")
## Clean the dataframe
parl <- parl[c(seq(from = 1,
to = 41,
by = 2))]
parl <- pivot_longer(parl,
1:21,
names_to = "parliament",
values_to = "name")
parl <- parl %>%
filter(!is.na(name))
## Make indicator variables to create year dummies
parl <- parl %>%
pivot_wider(names_from = 1, values_from = 1,
values_fn = list(parliament = length),
values_fill = list(parliament = 0))
parl[parl == 2] <- 1
## Clean the names a bit
parl$name <- str_replace(parl$name, "\\|(.*)", "")
# Now the dataframe is finished. String matching with politicians data as follows
## Import the identified data
polnames <- read_excel("Elections/Data/tk_1815tot1950uu.xlsx")
polnames <- polnames %>%
unite(name, 4,2, sep = " ", remove = FALSE)
## Pretreat polnames
### Extract end year numbers
polnames <- polnames %>%
separate(11,
c("year","month","day"),
sep = "-",
remove = FALSE)
## Filter on End year
polnames <- polnames %>%
filter(year > 1860)
#First, I import the file were the exact matches are located (manually checked)
parl <- read.csv("Elections/Data/match_corrected.csv", colClasses=c(rep("character",3),rep("numeric",21)))
#Now, finally, merge parl with the analysis sheet with wealth using
#the identifier number in both
wealth <-read_excel("Elections/Data/AnalysisFile.xlsx", sheet = "Analysis")
wealth <- wealth[,c(1:29, 35, 36)]
wealth <- clean_names(wealth)
test <- left_join(parl, polnames,
by = c("id_match" =  "b1-nummer")
)
test <- left_join(test, wealth,
by = c("id_match" = "indexnummer")
)
test <- test %>%
mutate(harnas2 = ifelse(yod - endyr < 3, 1, 0),
harnas5 = ifelse(yod - endyr < 6, 1, 0)
)
View(test)
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1) %>%
group_by(parliament, harnas2) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
View(test2)
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas2)) %>%
group_by(parliament, harnas2) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
se = sd(w_deflated, na.rm = TRUE),
count = n())
View(test2)
test2 <- test %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas2)) %>%
group_by(parliament, harnas2) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
View(test2)
#First, I import the file were the exact matches are located (manually checked)
parl <- read.csv("Elections/Data/match_corrected.csv", colClasses=c(rep("character",3),rep("numeric",21)))
#Now, finally, merge parl with the analysis sheet with wealth using
#the identifier number in both
wealth <-read_excel("Elections/Data/AnalysisFile.xlsx", sheet = "Analysis")
wealth <- wealth[,c(1:29, 35, 36)]
wealth <- clean_names(wealth)
parl <- left_join(parl, polnames,
by = c("id_match" =  "b1-nummer")
)
parl <- left_join(parl, wealth,
by = c("id_match" = "indexnummer")
)
parl <- parl %>%
mutate(harnas2 = ifelse(yod - endyr < 3, 1, 0),
harnas5 = ifelse(yod - endyr < 6, 1, 0)
)
test2 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas2)) %>%
group_by(parliament, harnas2) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
test3 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas2)) %>%
group_by(parliament, harnas2) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
View(test2)
View(test3)
grid2 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas2)) %>%
group_by(parliament, harnas2) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
grid3 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas5)) %>%
group_by(parliament, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
View(grid2)
View(grid3)
View(parl)
grid2 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas2)) %>%
group_by(parliament, harnas2) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
grid3 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1, !is.na(harnas5)) %>%
group_by(parliament, harnas5) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
View(grid2)
View(grid3)
grid1 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
View(grid1)
grid1 <- parl %>%
pivot_longer(4:24,
names_to = "parliament",
values_to = "indicator") %>%
filter(indicator == 1) %>%
group_by(parliament) %>%
summarise(mean = mean(w_deflated, na.rm = TRUE),
median = median(w_deflated, na.rm = TRUE),
count = n(),
se = sd(w_deflated, na.rm = TRUE)/sqrt(count))
View(grid1)
View(grid1)
?geom_errorbar
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = median)) + geom_line() + geom_errorbar(ymin = -1.96*se, ymax = 1.96*se)
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = median)) + geom_line() + geom_errorbar(data = grid1, ymin = -1.96*se, ymax = 1.96*se)
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = median)) + geom_line() + geom_errorbar(aes(ymin = -1.96*se, ymax = 1.96*se))
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = median)) + geom_point() + geom_errorbar(aes(ymin = -1.96*se, ymax = 1.96*se))
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = median)) + geom_point() + geom_errorbar(aes(ymin = median + -1.96*se, ymax = median + 1.96*se))
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) + geom_point() + geom_errorbar(aes(ymin = mean + -1.96*se, ymax = median + 1.96*se))
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) + geom_point() + geom_errorbar(aes(ymin = mean + -1.96*se, ymax = mean + 1.96*se))
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(ymin = mean + -1.96*se, ymax = mean + 1.96*se), size = 0.2)
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(ymin = mean + -1.96*se, ymax = mean + 1.96*se), size = 1)
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(ymin = mean + -1.96*se, ymax = mean + 1.96*se), size = 0.1)
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(ymin = mean + -1.96*se, ymax = mean + 1.96*se), width = 0.1)
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(ymin = mean + -1.96*se, ymax = mean + 1.96*se), width = 0.5)
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc()
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc()
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc() + ggtitle("Unconditional avg. wealth per parliament")
grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc() +
ggtitle("Unconditional avg. wealth per parliament")
p1 <- grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_point() +
geom_errorbar(aes(
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc() +
ggtitle("Unconditional avg. wealth per parliament")
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = as.factor(parliament), y = mean, color = harnas2)) +
geom_point() +
geom_errorbar(aes(
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = as.factor(parliament), y = mean, color = harnas2)) +
geom_line() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = parliament, y = mean, color = harnas2)) +
geom_line() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = parliament, y = mean, group = harnas2)) +
geom_line() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = parliament, y = mean, group = harnas2, color = harnas2)) +
geom_line() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
grid2 %>%
ggplot(aes(x = parliament, y = mean, group = as.factor(harnas2), color = as.factor(harnas2))) +
geom_line() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = parliament, y = mean, group = as.factor(harnas2), color = as.factor(harnas2))) +
geom_smooth() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = parliament, y = mean, group = as.factor(harnas2), color = as.factor(harnas2))) +
geom_line() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid2 %>%
ggplot(aes(x = parliament,
y = mean,
group = as.factor(harnas2),
color = as.factor(harnas2),
label = count)) +
geom_line() +
geom_text() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
p2 <- grid2 %>%
ggplot(aes(x = parliament,
y = mean,
group = as.factor(harnas2),
color = as.factor(harnas2),
label = count)) +
geom_line() +
geom_text() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
p3 <- grid3 %>%
ggplot(aes(x = parliament,
y = mean,
group = as.factor(harnas5),
color = as.factor(harnas5),
label = count)) +
geom_line() +
geom_text() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
View(p3)
p3
library(gridExtra)
grid.arrange(p1,p2,p3, nrow = 3)
p1 <- grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean)) +
geom_line() +
geom_errorbar(aes(
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc() +
ggtitle("Unconditional avg. wealth per parliament")
p2 <- grid2 %>%
ggplot(aes(x = parliament,
y = mean,
group = as.factor(harnas2),
color = as.factor(harnas2),
label = count)) +
geom_line() +
geom_text() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
p3 <- grid3 %>%
ggplot(aes(x = parliament,
y = mean,
group = as.factor(harnas5),
color = as.factor(harnas5),
label = count)) +
geom_line() +
geom_text() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid.arrange(p1,p2,p3, nrow = 3)
p1 <- grid1 %>%
ggplot(aes(x= as.factor(parliament), y = mean, group = 1)) +
geom_line() +
geom_errorbar(aes(
ymin = mean + -1.96*se, ymax = mean + 1.96*se),
width = 0.5) +
theme_ipsum_rc() +
ggtitle("Unconditional avg. wealth per parliament")
p2 <- grid2 %>%
ggplot(aes(x = parliament,
y = mean,
group = as.factor(harnas2),
color = as.factor(harnas2),
label = count)) +
geom_line() +
geom_text() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
p3 <- grid3 %>%
ggplot(aes(x = parliament,
y = mean,
group = as.factor(harnas5),
color = as.factor(harnas5),
label = count)) +
geom_line() +
geom_text() +
theme_ipsum_rc() +
ggtitle("Avg. wealth per parliament per value of HARNAS")
grid.arrange(p1,p2,p3, nrow = 3)
?ggsave
grid.arrange(p1,p2,p3, nrow = 3)
figure1 <- grid.arrange(p1,p2,p3, nrow = 3)
ggsave(figure1, height = 900, width = 800)
ggsave(figure1, "figure1.png", height = 900, width = 800)
?ggsave
ggsave("figure1.png",figure1, height = 900, width = 800)
ggsave("figure1.png",figure1, height = 8, width = 9)
